<!DOCTYPE html>
<html lang="en"><head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="advancement_files/libs/clipboard/clipboard.min.js"></script>
<script src="advancement_files/libs/quarto-html/tabby.min.js"></script>
<script src="advancement_files/libs/quarto-html/popper.min.js"></script>
<script src="advancement_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="advancement_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="advancement_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="advancement_files/libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<meta name="shiny-dependency-placeholder" content=""><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.40">

  <meta name="author" content="Abhijit Brahme">
  <meta name="dcterms.date" content="2025-01-13">
  <title>De-Mystifying Aging in Basketball</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="advancement_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="advancement_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="advancement_files/libs/revealjs/dist/theme/quarto-2a4c8bc07c7bed3f644724215556eb12.css">
  <link href="advancement_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="advancement_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="advancement_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="advancement_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
  
  <script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">De-Mystifying Aging in Basketball</h1>
  <p class="subtitle">A Latent Variable Approach</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Abhijit Brahme 
</div>
</div>
</div>

  <p class="date">2025-01-13</p>
</section>
<section id="research-interests" class="slide level2">
<h2>Research Interests</h2>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img data-src="images/noun-deep-learning-1705425.png"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img data-src="images/noun-scatter-graph-4768711.png"></p>
</div>
</div>
</div>
<aside class="notes">
<p>Generally work at the intersection of more modern advances in machine learning and statistics. Trying to find connections between these advances, and even instances where one field could help the other.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="current-projects" class="slide level2 scrollable">
<h2>Current Projects</h2>
<ol type="1">
<li class="fragment">Metric / Manifold Estimation from Trajectory Valued Data
<ul>
<li class="fragment">Prof.&nbsp;Nina Mialone (Dept. of Electrical Engineering)</li>
</ul></li>
<li class="fragment">Approximate HMC Methods
<ul>
<li class="fragment">Prof.&nbsp;Andrew Holbrook (UCLA, Dept of Public Health)</li>
</ul></li>
<li class="fragment"><strong>A Latent Variable Model for Modeling Multi-Dimensional Mixed Time-Series Data</strong>
<ul>
<li class="fragment"><strong>Prof.&nbsp;Alex Franks (Dept. of Statistics)</strong></li>
</ul></li>
</ol>
</section>
<section id="motivation" class="slide level2 scrollable">
<h2>Motivation</h2>
<div>
<ol type="1">
<li>Successfully forecast player performance, especially young players</li>
<li>Gain insight into how different observable metrics may peak at varying timepoints for certain “types” of players</li>
<li>Quantify a level of uncertainty regarding players’ future performance</li>
<li>Jointly model all of the above</li>
</ol>
</div>
<aside class="notes">
<p>The data are these time varying curves of specific observable and recorded metrics in basketball. Each one of these metrics is sort of an emission from an underlying latent state or ability. For example, we can look at LeBron James, who has had a long career and is in fact still playing. Some of these metrics are more “skill” based in that they aren’t affected by physical aging. For example, the ability to make free-throws is not really an athletic feat. Whereas, things like getting rebounds or scoring, are affected by age. So for example, there is some variation amongst metrics themselves in where they peak, as well as variation within individuals, usually by position.</p>
<p>So, if we look at Stephen Curry by contrast, he is a smaller guard. He is shorter, and not as athletic as LeBron, and so drop-off in his athleticism will appear more sharp as it is not mitigated by physical strength or height. The model, nor the data, doesn’t encode any of this explicitly, but the goal is to learn such variations through a latent embedding of players. We want to learn how to place players in some latent space where their position in the latent space tells us how they will age.</p>
<p>More so, we want to establish some measure of uncertainty about where players are placed. This is typically more important for rookies (new players) who just entered the league and we are sort of looking to model their future performance. Sort of an important task for team managers is to project performance and putting a level of uncertainty to an estimate is helpful in decision making.</p>
<p>Additionally, we want to be able to learn something about aging in general. How do different types of players age? How does that affect where they peak in certain metrics? So to do all of this, we want to model everything jointly.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="relevant-work" class="slide level2 scrollable">
<h2>Relevant Work</h2>
<ol type="1">
<li class="fragment">Bayesian Hierarchical Framework
<ul>
<li class="fragment">Hierarchical aging model applied to hockey, golf, and baseball <span class="citation" data-cites="berry1999bridging">(<a href="#/references" role="doc-biblioref" onclick="">Berry, Reese, and Larkey 1999</a>)</span></li>
<li class="fragment">Gaussian Process regressions by different basketball positions <span class="citation" data-cites="page2013effect">(<a href="#/references" role="doc-biblioref" onclick="">Page, Barney, and McGuire 2013</a>)</span></li>
<li class="fragment">Parametric curves analyzing pre and post peak-performance <span class="citation" data-cites="vaci2019large">(<a href="#/references" role="doc-biblioref" onclick="">Vaci et al. 2019</a>)</span></li>
</ul></li>
<li class="fragment">Functional Data Analysis
<ul>
<li class="fragment">Functional principal components clustering <span class="citation" data-cites="wakim2014functional">(<a href="#/references" role="doc-biblioref" onclick="">Wakim and Jin 2014</a>)</span></li>
<li class="fragment"><strong>Nearest Neighbor algorithm to characterize similarity between players <span class="citation" data-cites="natesilver538_2015">(<a href="#/references" role="doc-biblioref" onclick="">Silver 2015</a>)</span></strong></li>
<li class="fragment">Production curves as a convex combination of curves from the same set of archetype <span class="citation" data-cites="vinue2015archetypoids">(<a href="#/references" role="doc-biblioref" onclick="">Vinué, Epifanio, and Alemany 2015</a>)</span></li>
</ul></li>
</ol>
<aside class="notes">
<p>So there’s already been some kind of work in this area already. Some of this work is using specifically player positions to develop projections. But, these positions are kind of rigid in explaining the intricacies of basketball and similarities between players. We really want a continuous measure.</p>
<p>The paper that is most similar is this functional principal components clustering, but that works on the space of 1 metric / measure. and Nate silver’s method. Again, they are not jointly learning these things.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="data-overview" class="slide level2 scrollable">
<h2>Data Overview</h2>
<div>
<ol type="1">
<li><span class="math inline">\(\approx\)</span> 3,000 NBA players from years 1997 - 2021, from the ages of 18 - 39</li>
<li>Longitudinal mixed tensor valued data <span class="math inline">\(\mathcal{Y}\)</span> of size <span class="math inline">\(N\)</span> by <span class="math inline">\(T\)</span> by <span class="math inline">\(K\)</span> where <span class="math inline">\(N\)</span> is the number of players, <span class="math inline">\(T\)</span> is the number of years in a player’s career, and <span class="math inline">\(K\)</span> are the number of production metric curves with <span class="math inline">\(\mathcal{Y}_{ntk}\)</span> is missing if player <span class="math inline">\(n\)</span> is not observed for metric <span class="math inline">\(k\)</span> at age <span class="math inline">\(t\)</span>.
<ul>
<li>Non-missing entries are observations from exponential families (i.e Binomial, Gaussian, Exponential, Poisson, etc.)</li>
</ul></li>
<li><span class="math inline">\(\Omega\)</span> is binary tensor of same size as <span class="math inline">\(\mathcal{Y}\)</span> indicating missingness.</li>
</ol>
</div>
</section>
<section id="distributional-assumptions" class="slide level2 scrollable">
<h2>Distributional Assumptions</h2>
<p>We include the following metrics and distribution families:</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<ol type="1">
<li>Poisson
<ul>
<li><span class="math inline">\(\mathcal{R} =\)</span> {FG2A, FG3A, FTA, BLK, OREB, DREB, TOV, AST, STL}</li>
</ul></li>
<li>Gaussian
<ul>
<li><span class="math inline">\(\mathcal{G} =\)</span> {DBPM, OBPM}</li>
</ul></li>
<li>Binomial
<ul>
<li><span class="math inline">\(\mathcal{B} =\)</span> {FG2M, FG3M, FTM}</li>
<li><span class="math inline">\(\mathcal{A} =\)</span> {FG2A, FG3A, FTA}</li>
</ul></li>
<li>Exponential
<ul>
<li><span class="math inline">\(\mathcal{M} =\)</span> {Minutes}</li>
</ul></li>
<li>Bernoulli
<ul>
<li><span class="math inline">\(\mathcal{K} =\)</span> {Retirement}</li>
</ul></li>
</ol>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<p><span class="math display">\[\begin{align}
Y^k_{t}  &amp;\sim
\begin{cases}
Pois(Y^m_t e^{f^k_{t}}) \text{if } k \in \mathcal{R} \text{ , } \forall m \in \mathcal{M} \\
Bin(Y^j_{t}, logit^{-1}(f^k_{t})) \text{ if } k \in \mathcal{B} \text{ , }  j \in \mathcal{A} \\
\mathcal{N}(f^k_{t}, \frac{\sigma^2_k}{Y^m_t})  \text{ if } k \in \mathcal{G} \text{ , } \forall m \in \mathcal{M}\\
Bern(logit^{-1}(f^k_t)) \text{ if } k \in \mathcal{K}\\
Exp(e^{f^k_t}) \text{ if  } k \in \mathcal{M}
\end{cases}
\end{align}\]</span></p>
</div>
</div>
</div>
<aside class="notes">
<p>One thing to take note of here is that we are handling exposure parameters properly here. So, for example the total rebounds is scaled by the number of minutes played that year. Similarly for the metrics like 3 point percentage, we include the number of attempts (which coincidentally is another metric). The gaussian metric’s variance is scaled by the minutes played as well. So in this way we handle varying levels of playing time (something that other papers don’t really look at.)</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="methods" class="slide level2 scrollable">
<h2>Methods</h2>

<img data-src="images/pgm_methods_flow.svg" class="quarto-figure quarto-figure-center r-stretch"><aside class="notes">
<p>In order to address identifiability issues and MCMC convergence, we propose the following scheme to estimate the latent space <span class="math inline">\(X\)</span> and functional coefficients <span class="math inline">\(\beta_{rtk}\)</span>.</p>
<ol type="1">
<li>Initialize <span class="math inline">\(X\)</span>
<ul>
<li>Probabilistic Tensor Decomposition
<ul>
<li>Helps better encapsulate similarities between players, so good to initialize with good similarity</li>
</ul></li>
</ul></li>
<li>Using the fixed <span class="math inline">\(X\)</span> from above, conduct inference on <span class="math inline">\(\beta_{rtk}, \sigma_k, \omega_r\)</span></li>
</ol>
<p>Convex tensor decomposition decomposes one of the modes (time) into convex / concave functions over time.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="probabilistic-tensor-decomposition" class="slide level2">
<h2>Probabilistic Tensor Decomposition</h2>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img data-src="images/cp_decomp.jpg"></p>
</div>
</div>
</div>
<p>This model seeks to factorize the <span class="math inline">\(N \times T \times K\)</span> linear scale tensor <span class="math inline">\(A\)</span> using CP Decomposition. Since we have various outputs that are not normally distributed, this becomes a form of exponential family CP Decomposition.</p>
<p>Can simply think of this as <strong>Multi-modal PCA</strong>.</p>
</section>
<section id="latent-space" class="slide level2">
<h2>Latent Space</h2>
</section>
<section id="projection-results" class="slide level2">
<h2>Projection Results</h2>
</section>
<section id="posterior-distribution-of-peaks" class="slide level2">
<h2>Posterior Distribution of Peak(s)</h2>
<div id="131e6477" class="cell" data-execution_count="11">
<div class="cell-output cell-output-display">
<div id="post_dist_peak" class="shiny-ipywidget-output shiny-report-size shiny-report-theme html-fill-item html-fill-container"></div><script type="application/json" data-html-dependency="">{"name": "ipywidget-output-binding", "version": "0.4.2", "source": {"package": "shinywidgets", "subdir": "static"}, "script": [{"src": "libembed-amd.js"}, {"src": "output.js"}], "stylesheet": [{"href": "shinywidgets.css", "rel": "stylesheet"}], "meta": [], "all_files": false, "head": null}</script>
<script type="application/json" data-html-dependency="">{"name": "headcontent_64c93189711f8969640e7b8f06f689fadea80c2e", "version": "0.0", "source": null, "script": [], "stylesheet": [], "meta": [], "all_files": false, "head": "<script data-jupyter-widgets-cdn=\"https://cdn.jsdelivr.net/npm/\"><\/script>"}</script>
<script type="application/json" data-html-dependency="">{"name": "htmltools-fill", "version": "0.5.8.9000", "source": {"package": "shiny", "subdir": "www/shared/htmltools/fill"}, "script": [], "stylesheet": [{"href": "fill.css", "rel": "stylesheet"}], "meta": [], "all_files": false, "head": null}</script>
</div>
</div>
</section>
<section id="functional-basis" class="slide level2">
<h2>Functional Basis</h2>

<img data-src="images/tuckerdecomp.png" class="r-stretch"><p>Let <span class="math inline">\(\mathcal{X}\)</span> be the tensor of normalized gaussian-scale linear predictors of dimension <span class="math inline">\(N \times T \times K\)</span>. Then, <span class="math inline">\(\mathcal{X}\)</span> is decomposed into a “core” tensor <span class="math inline">\(\mathcal{Y}\)</span> of dimension <span class="math inline">\(N \times M \times K\)</span> and “factor” matrices <span class="math inline">\(A \in \mathbb{R}^{N \times N}\)</span>, <span class="math inline">\(B \in \mathbb{R}^{T \times M}\)</span>, <span class="math inline">\(C \in \mathbb{R}^{K \times K}\)</span>.</p>
<p>These bases in <span class="math inline">\(B\)</span> represent the set of common curves across time present in all players. By ensuring that <span class="math inline">\(A\)</span> and <span class="math inline">\(C\)</span> are identity matrices, the horizontal “slices” of the core tensor represent how much different metrics contributed to each basis <strong>for each</strong> slice (player).</p>
</section>
<section id="functional-basis-results" class="slide level2">
<h2>Functional Basis Results</h2>
</section>
<section id="functional-basis-results-contd." class="slide level2">
<h2>Functional Basis Results (contd.)</h2>
</section>
<section id="future-work" class="slide level2 scrollable">
<h2>Future Work</h2>
<ol type="1">
<li class="fragment">Using a hybrid Gibbs-HMC routine, perform the following updates:
<ul>
<li class="fragment">Sample <span class="math inline">\(X\)</span>, <span class="math inline">\(\gamma\)</span> while holding all other parameters fixed using HMC proposal step</li>
<li class="fragment">Conditional on the sampled <span class="math inline">\(X\)</span> and <span class="math inline">\(\gamma\)</span>, sample the remaining parameters using HMC proposal step</li>
</ul></li>
<li class="fragment">Posterior Coverage Tests
<ul>
<li class="fragment">Holdout forecasting performance</li>
</ul></li>
</ol>
</section>
<section id="questions" class="title-slide slide level1 center">
<h1>Questions ?</h1>

</section>

<section>
<section id="references" class="title-slide slide level1 smaller scrollable">
<h1>References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-berry1999bridging" class="csl-entry" role="listitem">
Berry, Scott M, C Shane Reese, and Patrick D Larkey. 1999. <span>“Bridging Different Eras in Sports.”</span> <em>Journal of the American Statistical Association</em> 94 (447): 661–76.
</div>
<div id="ref-gundersen2020latent" class="csl-entry" role="listitem">
Gundersen, Gregory W., Michael Minyi Zhang, and Barbara E. Engelhardt. 2020. <span>“Latent Variable Modeling with Random Features.”</span> <a href="https://arxiv.org/abs/2006.11145">https://arxiv.org/abs/2006.11145</a>.
</div>
<div id="ref-page2013effect" class="csl-entry" role="listitem">
Page, Garritt L, Bradley J Barney, and Aaron T McGuire. 2013. <span>“Effect of Position, Usage Rate, and Per Game Minutes Played on <span>NBA</span> Player Production Curves.”</span> <em>Journal of Quantitative Analysis in Sports</em> 9 (4): 337–45.
</div>
<div id="ref-natesilver538_2015" class="csl-entry" role="listitem">
Silver, Nate. 2015. <span>“We’re Predicting the Career of Every <span>NBA</span> Player. <span>H</span>ere’s How.”</span> <em>FiveThirtyEight</em>. <a href="https://fivethirtyeight.com/features/how-were-predicting-NBA-player-career/" class="uri">https://fivethirtyeight.com/features/how-were-predicting-NBA-player-career/</a>; FiveThirtyEight.
</div>
<div id="ref-vaci2019large" class="csl-entry" role="listitem">
Vaci, Nemanja, Dijana Cocić, Bartosz Gula, and Merim Bilalić. 2019. <span>“Large Data and Bayesian Modeling—Aging Curves of <span>NBA</span> Players.”</span> <em>Behavior <span>R</span>esearch <span>M</span>ethods</em>, 1–21.
</div>
<div id="ref-vinue2015archetypoids" class="csl-entry" role="listitem">
Vinué, Guillermo, Irene Epifanio, and Sandra Alemany. 2015. <span>“Archetypoids: A New Approach to Define Representative Archetypal Data.”</span> <em>Computational Statistics &amp; Data Analysis</em> 87: 102–15.
</div>
<div id="ref-wakim2014functional" class="csl-entry" role="listitem">
Wakim, Alexander, and Jimmy Jin. 2014. <span>“Functional Data Analysis of Aging Curves in Sports.”</span> <em>arXiv Preprint arXiv:1403.7548</em>.
</div>
</div>
</section>
<section id="modeling-setup" class="slide level2 appendix">
<h2>Modeling Setup</h2>
<p>Space of players live in low dimensional latent space <span class="math inline">\(X \in \mathbb{R} ^{N \times D}\)</span></p>
<p>For a given time <span class="math inline">\(t\)</span>, and metric <span class="math inline">\(k\)</span>, <span class="math inline">\(f^k_t \sim \mathcal{GP}(0, K_X)\)</span> is a vector of size <span class="math inline">\(N\)</span>, with <span class="math inline">\(K_X\)</span> capturing correlation across the <span class="math inline">\(N\)</span> dimension <span class="citation" data-cites="gundersen2020latent">(<a href="#/references" role="doc-biblioref" onclick="">Gundersen, Zhang, and Engelhardt 2020</a>)</span></p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img data-src="images/pgm.svg"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<span class="math display">\[\begin{pmatrix}
  \vert &amp; \vert &amp; \cdots &amp; \vert &amp; \cdots &amp; \vert  \\
  \vert &amp; \vert &amp; \cdots &amp; \vert &amp; \cdots &amp; \vert  \\
  f^k_1 &amp; f^k_2 &amp; \cdots &amp; f^k_i &amp; \cdots &amp; f^k_T  \\
  \vert  &amp; \vert &amp; \cdots &amp; \vert &amp; \cdots &amp; \vert \\
  \vert  &amp; \vert &amp; \cdots  &amp; \vert &amp; \cdots  &amp; \vert
\end{pmatrix}\]</span>
</div>
</div>
</div>
</section>
<section id="random-fourier-features" class="slide level2 appendix">
<h2>Random Fourier Features</h2>
<p>Attempt to approximate the inner product <span class="math inline">\(k(x, y) = \langle \phi(x), \phi(y) \rangle\)</span> with a randomized map <span class="math inline">\(z: \mathbb{R}^D \rightarrow \mathbb{R}^R\)</span>. Computational savings arise if <span class="math inline">\(R &lt;&lt; N\)</span>.</p>
<p><strong>Approximation of Gaussian Process can be turned into a linear operation, <span class="math inline">\(f^k_{t}(X) \approx Z(X)^T\beta^k_{t}\)</span> which is computationally beneficial if <span class="math inline">\(N\)</span> large.</strong></p>
<p>In our case, we let <span class="math inline">\(k(x,y) = k(x - y) = exp(\frac{-||x - y||^2}{2})\)</span> be the standard radial basis kernel.</p>
<p>It can be shown that to produce the radial basis kernel, <span class="math inline">\(\omega \sim \mathcal{N}_D(0, I_d)\)</span>.</p>
<p>Thus the map is composed of <span class="math inline">\(z_{\omega_r} = [cos(\omega_r ^T x), sin(\omega_r ^ T x)]^T\)</span>.</p>
<p><span class="math inline">\(Z(X) = \frac{1}{\sqrt{R}}[z_{\omega_1}, z_{\omega_2}, \dots, z_{\omega_R}]^T\)</span></p>
</section>
<section id="adjusted-modeling-setup" class="slide level2 appendix">
<h2>Adjusted Modeling Setup</h2>

<img data-src="images/pmg_corr.svg" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="probabilistic-tensor-decomposition-contd." class="slide level2 appendix scrollable">
<h2>Probabilistic Tensor Decomposition (contd.)</h2>
<p>Let <span class="math inline">\(\tilde{A}_{pit} = g_{pit}^{-1}(A_{pit})\)</span>, where <span class="math inline">\(g_{pit}\)</span> is the appropriate link function transforming the linear scale parameter into the appropriate exponential family parameterization. Consequently, <span class="math inline">\(X, V, W, \mu\)</span> are estimated by maximizing the following loss function using gradient descent.</p>
<p><span class="math inline">\(\max_{X, V, W, \mu} \sum_{p, i, t} log( F_{pit}( Y_{pit} | \tilde{A}_{pit} )) \cdot \Omega_{pit}\)</span></p>
<p>where <span class="math inline">\(F_{pit}\)</span> is the appropriate distribution density function associated with entry <span class="math inline">\(Y_{pit}\)</span>.</p>
<p>This offers the following benefits:</p>
<ol type="1">
<li class="fragment">Latent space <span class="math inline">\(X\)</span> is created while accounting for sampling variability</li>
<li class="fragment">Latent space is created while also accounting for correlations across each mode of the tensor, which is representative of the final model.</li>
</ol>
</section>
<section id="enforcing-convexity" class="slide level2 appendix">
<h2>Enforcing Convexity</h2>
<p>Considering we only wish our function <span class="math inline">\(f(x,t)\)</span> to be convex in the <span class="math inline">\(t\)</span> argument, we wish to find all set of <span class="math inline">\(f(x,t)\)</span> such that <span class="math inline">\(\frac{\partial ^2 f(x,t)}{\partial t^2} \geq 0\)</span>. As such, our desired function has the form</p>
<p><span class="math inline">\(f(x,t) = D(x) + C(x)(t-a) + \int_{a}^t \int_{a}^s \frac{\partial ^2 f(x,z)}{\partial z^2}dzds\)</span></p>
<p>where <span class="math inline">\(D\)</span> and <span class="math inline">\(C\)</span> are constants of integration w.r.t <span class="math inline">\(t\)</span> which could also depend on <span class="math inline">\(x\)</span>.</p>
<p>Key idea: model <span class="math inline">\(\frac{\partial ^2 f(x,t)}{\partial t^2}\)</span> as the square of a Gaussian Process (<span class="math inline">\(g(x,t)\)</span>) approximated by basis functions.</p>
</section>
<section id="enforcing-convexity-concavity-contd." class="slide level2 appendix scrollable">
<h2>Enforcing Convexity / Concavity (contd.)</h2>
<ol type="1">
<li class="fragment"><span class="math inline">\(g(x,t) \approx \sum_{i=1}^M \beta_i(t) \phi_i(x)\)</span> using RFF approximation.
<ul>
<li class="fragment">Here, <span class="math inline">\(\beta_i(t)\)</span> are <span class="math inline">\(t\)</span> - dependent coefficients of the basis expansion of <span class="math inline">\(x\)</span>.</li>
<li class="fragment">Can be shown that <span class="math inline">\(Cov(g(x,t)) \approx K_x \bigotimes K_t\)</span> if <span class="math inline">\(\beta_i(t) \sim \mathcal{GP}(0, K_t)\)</span></li>
</ul></li>
<li class="fragment"><span class="math inline">\(\beta_i(t) \approx \sum_{l=1}^K S(\sqrt{\lambda_l})^{1/2} \alpha_l^i \psi_l(t)\)</span> using the Hilbert Space Approximation
<ul>
<li class="fragment">Substitute in the above equation, and still <span class="math inline">\(Cov(g(x,t)) \approx K_x \bigotimes K_t\)</span> if <span class="math inline">\(\beta_i(t) \sim \mathcal{GP}(0, K_t)\)</span></li>
</ul></li>
<li class="fragment">We can compute the previous integral since <span class="math inline">\(\psi_l(t)\)</span> are sinusoidal functions.
<ul>
<li class="fragment"><strong>resulting function is not necessarily a gaussian process</strong></li>
<li class="fragment"><strong>convexity only guaranteed in the Gaussian response case, as exponential link functions are not guaranteed to preserve the result</strong></li>
</ul></li>
</ol>

</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="advancement_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="advancement_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="advancement_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="advancement_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="advancement_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="advancement_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="advancement_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="advancement_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="advancement_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="advancement_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': true,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>